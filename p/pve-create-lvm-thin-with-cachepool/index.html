<!DOCTYPE html>
<html lang="zh-cn" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content=" å…³é”®è¯ï¼šPVE | Proxmox VE | RAID | RAID0 | LVM | LVM-thin | ç¼“å­˜ | cache | HDD | SSD\nå‰è¨€ æœ€è¿‘åœ¨æŸ¥é˜…èµ„æ–™å„ç§èµ„æ–™ï¼Œçœ‹çœ‹PVEå•æœåŠ¡å™¨ç³»ç»Ÿä¸­ï¼Œèƒ½ç”¨ä»€ä¹ˆæ ·çš„æ–¹å¼ï¼Œæå‡LVM-thinå­˜å‚¨çš„IOæ€§èƒ½ã€‚æœ‰å¤šæœåŠ¡å™¨æ¡ä»¶çš„å½“ç„¶æ˜¯ä¸ŠCEPHäº†ï¼Œæ²¡æœ‰å¤šæœåŠ¡å™¨çš„æ¡ä»¶è€Œå†…å­˜åˆæ¯”è¾ƒå……è¶³çš„æƒ…å†µä¸‹ä½¿ç”¨ZFSä¹Ÿä¸é”™ã€‚ä½†æˆ‘ä¸¤ç§æ¡ä»¶éƒ½ä¸å…·å¤‡ã€‚\n">
<title>PVEåŸºäºraid0åˆ›å»ºLVM-thinå¹¶æ·»åŠ å›ºæ€ç£ç›˜ä½œä¸ºç¼“å­˜æ± </title>

<link rel='canonical' href='https://evine.win/p/pve-create-lvm-thin-with-cachepool/'>

<link rel="stylesheet" href="/scss/style.min.6a692fd055deae459f2a9767f57f3855ba80cafd5041317f24f7360f6ca47cdf.css"><meta property='og:title' content="PVEåŸºäºraid0åˆ›å»ºLVM-thinå¹¶æ·»åŠ å›ºæ€ç£ç›˜ä½œä¸ºç¼“å­˜æ± ">
<meta property='og:description' content=" å…³é”®è¯ï¼šPVE | Proxmox VE | RAID | RAID0 | LVM | LVM-thin | ç¼“å­˜ | cache | HDD | SSD\nå‰è¨€ æœ€è¿‘åœ¨æŸ¥é˜…èµ„æ–™å„ç§èµ„æ–™ï¼Œçœ‹çœ‹PVEå•æœåŠ¡å™¨ç³»ç»Ÿä¸­ï¼Œèƒ½ç”¨ä»€ä¹ˆæ ·çš„æ–¹å¼ï¼Œæå‡LVM-thinå­˜å‚¨çš„IOæ€§èƒ½ã€‚æœ‰å¤šæœåŠ¡å™¨æ¡ä»¶çš„å½“ç„¶æ˜¯ä¸ŠCEPHäº†ï¼Œæ²¡æœ‰å¤šæœåŠ¡å™¨çš„æ¡ä»¶è€Œå†…å­˜åˆæ¯”è¾ƒå……è¶³çš„æƒ…å†µä¸‹ä½¿ç”¨ZFSä¹Ÿä¸é”™ã€‚ä½†æˆ‘ä¸¤ç§æ¡ä»¶éƒ½ä¸å…·å¤‡ã€‚\n">
<meta property='og:url' content='https://evine.win/p/pve-create-lvm-thin-with-cachepool/'>
<meta property='og:site_name' content='Evineçš„ä¸ªäººåšå®¢'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='pve' /><meta property='article:tag' content='lvm-thin' /><meta property='article:tag' content='cachepool' /><meta property='article:published_time' content='2022-09-01T00:00:00&#43;08:00'/><meta property='article:modified_time' content='2023-10-26T21:56:46&#43;08:00'/><meta property='og:image' content='https://evine.win/p/pve-create-lvm-thin-with-cachepool/pic3.png' />
<meta name="twitter:title" content="PVEåŸºäºraid0åˆ›å»ºLVM-thinå¹¶æ·»åŠ å›ºæ€ç£ç›˜ä½œä¸ºç¼“å­˜æ± ">
<meta name="twitter:description" content=" å…³é”®è¯ï¼šPVE | Proxmox VE | RAID | RAID0 | LVM | LVM-thin | ç¼“å­˜ | cache | HDD | SSD\nå‰è¨€ æœ€è¿‘åœ¨æŸ¥é˜…èµ„æ–™å„ç§èµ„æ–™ï¼Œçœ‹çœ‹PVEå•æœåŠ¡å™¨ç³»ç»Ÿä¸­ï¼Œèƒ½ç”¨ä»€ä¹ˆæ ·çš„æ–¹å¼ï¼Œæå‡LVM-thinå­˜å‚¨çš„IOæ€§èƒ½ã€‚æœ‰å¤šæœåŠ¡å™¨æ¡ä»¶çš„å½“ç„¶æ˜¯ä¸ŠCEPHäº†ï¼Œæ²¡æœ‰å¤šæœåŠ¡å™¨çš„æ¡ä»¶è€Œå†…å­˜åˆæ¯”è¾ƒå……è¶³çš„æƒ…å†µä¸‹ä½¿ç”¨ZFSä¹Ÿä¸é”™ã€‚ä½†æˆ‘ä¸¤ç§æ¡ä»¶éƒ½ä¸å…·å¤‡ã€‚\n"><meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content='https://evine.win/p/pve-create-lvm-thin-with-cachepool/pic3.png' />
    <link rel="shortcut icon" href="/favicon.ico" />

      <script async src="https://www.googletagmanager.com/gtag/js?id=G-5SWJSDBST9"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-5SWJSDBST9');
        }
      </script>
    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="åˆ‡æ¢èœå•">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/avatar_hu_ef9958f7a0605821.png" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
                    <span class="emoji">ğŸ¥</span>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">Evineçš„ä¸ªäººåšå®¢</a></h1>
            <h2 class="site-description">Pain demands to be felt.</h2>
        </div>
    </header><ol class="menu-social">
            
                <li>
                    <a 
                        href='https://github.com/devome'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>ä¸»é¡µ</span>
            </a>
        </li>
        
        
        <li >
            <a href='/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>æ–‡ç« </span>
            </a>
        </li>
        
        
        <li >
            <a href='/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>æœç´¢</span>
            </a>
        </li>
        
        
        <li >
            <a href='/link/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5" />
  <path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5" />
</svg>



                
                <span>å‹é“¾</span>
            </a>
        </li>
        
        <li class="menu-bottom-section">
            <ol class="menu">

                
                    <li id="dark-mode-toggle">
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <span>æš—è‰²æ¨¡å¼</span>
                    </li>
                
            </ol>
        </li>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">ç›®å½•</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li><a href="#å‰è¨€">å‰è¨€</a></li>
    <li><a href="#æœ‰å…³æ¦‚å¿µ">æœ‰å…³æ¦‚å¿µ</a></li>
    <li><a href="#åˆ›å»ºå…·æœ‰ç¼“å­˜æ± çš„lvm-thinå­˜å‚¨">åˆ›å»ºå…·æœ‰ç¼“å­˜æ± çš„LVM-thinå­˜å‚¨</a>
      <ol>
        <li><a href="#å…ˆçœ‹çœ‹ç£ç›˜çš„è¯†åˆ«æƒ…å†µ">å…ˆçœ‹çœ‹ç£ç›˜çš„è¯†åˆ«æƒ…å†µ</a></li>
        <li><a href="#å¯¹ç£ç›˜åˆå§‹åŒ–">å¯¹ç£ç›˜åˆå§‹åŒ–</a></li>
        <li><a href="#å…¨éƒ¨åˆ†å¥½åŒºå†è¾“å…¥lsblkæ£€æŸ¥ä¸€ä¸‹">å…¨éƒ¨åˆ†å¥½åŒºå†è¾“å…¥<code>lsblk</code>æ£€æŸ¥ä¸€ä¸‹ï¼š</a></li>
        <li><a href="#åˆ›å»ºpv">åˆ›å»ºPV</a></li>
        <li><a href="#åˆ›å»ºvg">åˆ›å»ºVG</a></li>
        <li><a href="#åˆ›å»ºæ•°æ®lv">åˆ›å»ºæ•°æ®LV</a></li>
        <li><a href="#åˆ›å»ºå…ƒæ•°æ®lvå’Œç¼“å­˜æ± å…ƒæ•°æ®lv">åˆ›å»ºå…ƒæ•°æ®LVå’Œç¼“å­˜æ± å…ƒæ•°æ®LV</a></li>
        <li><a href="#åˆ›å»ºç¼“å­˜æ± æ•°æ®lv">åˆ›å»ºç¼“å­˜æ± æ•°æ®LV</a></li>
        <li><a href="#è½¬æ¢å­˜å‚¨ç±»å‹">è½¬æ¢å­˜å‚¨ç±»å‹</a></li>
      </ol>
    </li>
    <li><a href="#æ£€æŸ¥">æ£€æŸ¥</a></li>
    <li><a href="#æ·»åŠ å­˜å‚¨">æ·»åŠ å­˜å‚¨</a></li>
    <li><a href="#å‚è€ƒèµ„æ–™">å‚è€ƒèµ„æ–™</a></li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="has-image main-article">
    <header class="article-header">
        <div class="article-image">
            <a href="/p/pve-create-lvm-thin-with-cachepool/">
                <img src="/p/pve-create-lvm-thin-with-cachepool/pic3_hu_7014b07811130390.png"
                        srcset="/p/pve-create-lvm-thin-with-cachepool/pic3_hu_7014b07811130390.png 800w, /p/pve-create-lvm-thin-with-cachepool/pic3_hu_6df981802ff2f8ac.png 1600w"
                        width="800" 
                        height="337" 
                        loading="lazy"
                        alt="Featured image of post PVEåŸºäºraid0åˆ›å»ºLVM-thinå¹¶æ·»åŠ å›ºæ€ç£ç›˜ä½œä¸ºç¼“å­˜æ± " />
                
            </a>
        </div>
    

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/pve/" style="background-color: #2a9d8f; color: #fff;">
                Promox VE
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/p/pve-create-lvm-thin-with-cachepool/">PVEåŸºäºraid0åˆ›å»ºLVM-thinå¹¶æ·»åŠ å›ºæ€ç£ç›˜ä½œä¸ºç¼“å­˜æ± </a>
        </h2>
    
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">2022-09-01</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    é˜…è¯»æ—¶é•¿: 17 åˆ†é’Ÿ
                </time>
            </div>
        
    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
    
    <blockquote>
<p>å…³é”®è¯ï¼šPVE | Proxmox VE | RAID | RAID0 | LVM | LVM-thin | ç¼“å­˜ | cache | HDD | SSD</p>
</blockquote>
<h2 id="å‰è¨€">å‰è¨€
</h2><p>æœ€è¿‘åœ¨æŸ¥é˜…èµ„æ–™å„ç§èµ„æ–™ï¼Œçœ‹çœ‹PVEå•æœåŠ¡å™¨ç³»ç»Ÿä¸­ï¼Œèƒ½ç”¨ä»€ä¹ˆæ ·çš„æ–¹å¼ï¼Œæå‡LVM-thinå­˜å‚¨çš„IOæ€§èƒ½ã€‚æœ‰å¤šæœåŠ¡å™¨æ¡ä»¶çš„å½“ç„¶æ˜¯ä¸ŠCEPHäº†ï¼Œæ²¡æœ‰å¤šæœåŠ¡å™¨çš„æ¡ä»¶è€Œå†…å­˜åˆæ¯”è¾ƒå……è¶³çš„æƒ…å†µä¸‹ä½¿ç”¨ZFSä¹Ÿä¸é”™ã€‚ä½†æˆ‘ä¸¤ç§æ¡ä»¶éƒ½ä¸å…·å¤‡ã€‚</p>
<p>ä½œä¸ºåƒåœ¾ä½¬ï¼Œæ€ä¹ˆèˆå¾—å†é¢å¤–è´­ç½®ç¡¬ä»¶å¤šèŠ±é’±å‘¢ã€‚åƒåœ¾ä½¬å½“ç„¶ä¸æ„¿æ„å†è´­ä¹°æ–°ç¡¬ç›˜äº†ï¼Œæå‡ºå¤šå¹´å‰ç»™å°å¼æœºè£…ç³»ç»Ÿçš„ä¸¤å—SATAæ¥å£çš„å›ºæ€ç¡¬ç›˜ï¼Œä»¥åŠä»¥å‰å°å¼æœºç”¨çš„ä¸¤å—æœºæ¢°ç¡¬ç›˜ï¼Œå‡†å¤‡å°†ä¸¤å—SSDç»„raid0åä½œä¸ºç¼“å­˜æ± ï¼Œä¸ºä¸¤å—HDDä»¥raid0ç»„ååˆ›å»ºçš„LVM-thinæä¾›è¯»å†™ç¼“å­˜æœåŠ¡ã€‚</p>
<div class="table-wrapper"><table>
  <thead>
      <tr>
          <th style="text-align: center">ç¡¬ç›˜ç±»å‹</th>
          <th style="text-align: center">å‹å·</th>
          <th style="text-align: center">ç¡¬ç›˜å¤§å°</th>
          <th style="text-align: center">é€šç”µæ—¶é•¿</th>
          <th style="text-align: center">å‡ºå‚æ—¶é—´</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: center">SSD</td>
          <td style="text-align: center">Samsung 840 EVO</td>
          <td style="text-align: center">120G</td>
          <td style="text-align: center">28744h</td>
          <td style="text-align: center">2014å¹´3æœˆ</td>
      </tr>
      <tr>
          <td style="text-align: center">SSD</td>
          <td style="text-align: center">Samsung 850 EVO</td>
          <td style="text-align: center">120G</td>
          <td style="text-align: center">22981h</td>
          <td style="text-align: center">2015å¹´5æœˆ</td>
      </tr>
      <tr>
          <td style="text-align: center">HDD</td>
          <td style="text-align: center">WD20EZRX</td>
          <td style="text-align: center">2T</td>
          <td style="text-align: center">55700h</td>
          <td style="text-align: center">2013å¹´2æœˆ</td>
      </tr>
      <tr>
          <td style="text-align: center">HDD</td>
          <td style="text-align: center">HGST HUA723020ALA640</td>
          <td style="text-align: center">2T</td>
          <td style="text-align: center">19267h</td>
          <td style="text-align: center">2013å¹´12æœˆ</td>
      </tr>
  </tbody>
</table></div>
<p>å’Œæˆ‘çš„ä½¿ç”¨åœºæ™¯ã€ç¡¬ä»¶æ¡ä»¶ä¸€æ¨¡ä¸€æ ·å‡ ä¹æ˜¯ä¸å¯èƒ½çš„ï¼Œä¹Ÿå°±å‡ ä¹ä¸å¯èƒ½æœ‰äººèƒ½å¤Ÿå®Œå…¨ç…§æ¬æˆ‘çš„æ“ä½œè¿‡ç¨‹ï¼Œæ‰€ä»¥æœ¬æ–‡ä¹Ÿä»…æ˜¯æä¾›ä¸€ç§æ€è·¯ï¼ŒLVMä¾é å®ƒå·²ç»æä¾›çš„å„ç§åŠŸèƒ½ï¼Œå¯ä»¥å®ç°å„ç§ä½ æƒ³å¾—åˆ°æƒ³ä¸åˆ°çš„ç©æ³•ã€‚è¿™é‡Œä¸¾ä¸‰ä¸ªä¾‹å­ï¼š</p>
<ul>
<li>
<p>2å—2Tçš„HDDã€1å—3Tçš„HDDï¼Œ3å—HDDåˆ†åˆ«åˆ›å»ºä¸€ä¸ª2Tçš„åˆ†åŒºï¼Œå…±3ä¸ª2TiBçš„åˆ†åŒºç»„å»º6Tå¤§å°3ä¸ªPVçš„raid0çš„LVMæˆ–LVM-thinï¼›å†å°†3Tç›˜æ²¡æœ‰ç”¨åˆ°çš„1Tç©ºé—´å•ç‹¬å†åˆ›å»ºä¸ªdirå­˜å‚¨ï¼Œç”¨äºä¿å­˜å¤‡ä»½æ–‡ä»¶ã€é•œåƒæ–‡ä»¶ç­‰ã€‚</p>
</li>
<li>
<p>1å—256Gçš„nvmeç£ç›˜ï¼Œå®‰è£…ç³»ç»Ÿå·²ç»å ç”¨äº†50Gï¼Œä½™ä¸‹çš„ç©ºé—´å¤§åˆä¸å¤§ï¼Œå°åˆä¸å°ï¼Œå•ç‹¬ç”¨å¥½åƒä¹Ÿå¹²ä¸äº†ä»€ä¹ˆå¤ªå¤šçš„äº‹ã€‚ç³»ç»Ÿå·²ç»é»˜è®¤åˆ›å»ºäº†local-lvmï¼Œä½†æ˜¯å¯ä»¥å°†local-lvmåˆ é™¤ï¼Œç„¶åå°†äº§ç”Ÿçš„çº¦200Gç©ºé—´ä½œä¸ºå…¶ä»–HDDç£ç›˜çš„ç¼“å­˜æ± ï¼Œæå‡IOæ€§èƒ½ã€‚</p>
</li>
<li>
<p>4å—4Tçš„HDDç»„raid5åå†è½¬æ¢ä¸ºLVMï¼Œç„¶åä¸€å—256Gçš„nvmeç£ç›˜ä½œä¸ºå…¶ç¼“å­˜æ± ã€‚</p>
</li>
</ul>
<h2 id="æœ‰å…³æ¦‚å¿µ">æœ‰å…³æ¦‚å¿µ
</h2><blockquote>
<p>PV(physical volume)ï¼šç‰©ç†å·ï¼Œåœ¨é€»è¾‘å·ç®¡ç†ç³»ç»Ÿæœ€åº•å±‚ï¼Œå¯ä¸ºæ•´ä¸ªç‰©ç†ç¡¬ç›˜æˆ–å®é™…ç‰©ç†ç¡¬ç›˜ä¸Šçš„åˆ†åŒºã€‚</p>
</blockquote>
<blockquote>
<p>VG(volume group)ï¼šå·ç»„ï¼Œå»ºç«‹åœ¨ç‰©ç†å·ä¸Šï¼Œä¸€å·ç»„ä¸­è‡³å°‘è¦åŒ…æ‹¬ä¸€ç‰©ç†å·ï¼Œå·ç»„å»ºç«‹åå¯åŠ¨æ€çš„æ·»åŠ å·åˆ°å·ç»„ä¸­ï¼Œä¸€ä¸ªé€»è¾‘å·ç®¡ç†ç³»ç»Ÿå·¥ç¨‹ä¸­å¯æœ‰å¤šä¸ªå·ç»„ã€‚</p>
</blockquote>
<blockquote>
<p>LV(logical volume)ï¼šé€»è¾‘å·ï¼Œå»ºç«‹åœ¨å·ç»„åŸºç¡€ä¸Šï¼Œå·ç»„ä¸­æœªåˆ†é…ç©ºé—´å¯ç”¨äºå»ºç«‹æ–°çš„é€»è¾‘å·ï¼Œé€»è¾‘å·å»ºç«‹åå¯ä»¥åŠ¨æ€æ‰©å±•å’Œç¼©å°ç©ºé—´ã€‚</p>
</blockquote>
<blockquote>
<p>PE(physical extent)ï¼šç‰©ç†åŒºåŸŸï¼Œæ˜¯ç‰©ç†å·ä¸­å¯ç”¨äºåˆ†é…çš„æœ€å°å­˜å‚¨å•å…ƒï¼ˆæœ¬æ–‡é‡‡ç”¨é»˜è®¤å€¼4MiBï¼‰ï¼Œç‰©ç†åŒºåŸŸå¤§å°åœ¨å»ºç«‹å·ç»„æ—¶æŒ‡å®šï¼Œä¸€æ—¦ç¡®å®šä¸èƒ½æ›´æ”¹ï¼ŒåŒä¸€å·ç»„æ‰€æœ‰ç‰©ç†å·çš„ç‰©ç†åŒºåŸŸå¤§å°éœ€ä¸€è‡´ï¼Œæ–°çš„PVåŠ å…¥åˆ°VGåï¼ŒPEçš„å¤§å°è‡ªåŠ¨æ›´æ”¹ä¸ºVGä¸­å®šä¹‰çš„PEå¤§å°ã€‚</p>
</blockquote>
<blockquote>
<p>LE(logical extent)ï¼šé€»è¾‘åŒºåŸŸï¼Œæ˜¯é€»è¾‘å·ä¸­å¯ç”¨äºåˆ†é…çš„æœ€å°å­˜å‚¨å•å…ƒï¼Œé€»è¾‘åŒºåŸŸçš„å¤§å°å–å†³äºé€»è¾‘å·æ‰€åœ¨å·ç»„ä¸­çš„ç‰©ç†åŒºåŸŸçš„å¤§å°ã€‚</p>
</blockquote>
<p>ç½‘ä¸Šæœ‰å¾ˆå¤šæœ‰å…³æ¦‚å¿µçš„è¯¦ç»†ä»‹ç»ï¼Œè¿™é‡Œä¸å†å¤šè¯´ã€‚</p>
<h2 id="åˆ›å»ºå…·æœ‰ç¼“å­˜æ± çš„lvm-thinå­˜å‚¨">åˆ›å»ºå…·æœ‰ç¼“å­˜æ± çš„LVM-thinå­˜å‚¨
</h2><p>è¿™é‡Œéœ€è¦å¤§è‡´å…ˆè¯´æ˜ä¸€ä¸‹æˆ‘çš„æ€è·¯ï¼Œæˆ‘æ‰“ç®—å°†HDDå…¨éƒ¨ç©ºé—´ç»„raid0ï¼Œç„¶åç”¨ä½œæ•°æ®LVï¼›å°†SSDå…¨éƒ¨ç©ºé—´ç»„raid0ï¼Œç„¶åç”¨ä½œå…ƒæ•°æ®LVå’Œç¼“å­˜æ± LVï¼Œæœ€ç»ˆçš„å­˜å‚¨ç±»å‹æ˜¯LVM-thinã€‚åˆ†åˆ«å¦‚ä¸‹ï¼š</p>
<ul>
<li>
<p>æ•°æ®LVï¼šä¹Ÿå°±æ˜¯å­˜å‚¨LVM-thinåŸå§‹æ•°æ®çš„LVï¼Œæ‰€æœ‰æ•°æ®æœ€ç»ˆéœ€è¦å†™å…¥çš„åœ°æ–¹ï¼Œæˆ‘å°†åœ¨HDDä¸Šåˆ›å»ºå®ƒã€‚</p>
</li>
<li>
<p>å…ƒæ•°æ®LVï¼šLVM-thinçš„ç‰¹è‰²ï¼Œç›¸æ¯”LVMç›´æ¥æŒ‰å·å¤§å°é¢„å…ˆåˆ†é…æ‰€éœ€ç©ºé—´ï¼ŒLVM-thinåˆ™æ˜¯éœ€è¦å‘å·å†…å†™å…¥æ•°æ®æ—¶æ‰æŒ‰å®é™…å†™å…¥æ•°æ®é‡å¤§å°åˆ†é…æ‰€éœ€ç©ºé—´ã€‚LVM-thinéœ€è¦ç”¨æ¥ç´¢å¼•å®é™…æ•°æ®çš„å…ƒæ•°æ®metadataç©ºé—´ï¼Œå°±æ˜¯å…ƒæ•°æ®LVã€‚ä¸ºäº†æå‡æ•°æ®ç´¢å¼•é€Ÿåº¦ï¼Œæˆ‘å°†åœ¨SSDä¸Šåˆ›å»ºå®ƒã€‚</p>
</li>
<li>
<p>ç¼“å­˜æ± LVï¼šä¸ºäº†æå‡è®¿é—®æ•°æ®LVä¸­æ•°æ®çš„IOé€Ÿåº¦ï¼Œä½¿ç”¨SSDä¸ºå®ƒåˆ›å»ºç¼“å­˜æ± ï¼Œè¿™æ ·å¯ä»¥å°†ç»å¸¸è¯»å–çš„æ•°æ®åŠ è½½åˆ°ç¼“å­˜æ± ä¸­ï¼Œåç»­å†è¯»å–è¿™äº›æ•°æ®ä¼šæå‡IOï¼›åŒæ—¶è¦å†™å…¥æ•°æ®æ—¶ä¹Ÿå…ˆå†™å…¥ç¼“å­˜æ± ï¼Œå†™å…¥ä¹Ÿå¯ä»¥æ›´å¿«ã€‚ç¼“å­˜æ± LVä¹Ÿåˆ†ä¸ºæ•°æ®LVå’Œå…ƒæ•°æ®LVä¸¤éƒ¨åˆ†ã€‚</p>
<ul>
<li>
<p>ç¼“å­˜æ± æ•°æ®LVï¼šä¸´æ—¶å­˜å‚¨ç¼“å­˜æ•°æ®çš„åœ°æ–¹ï¼Œæˆ‘å°†åœ¨SSDä¸Šåˆ›å»ºå®ƒã€‚</p>
</li>
<li>
<p>ç¼“å­˜æ± å…ƒæ•°æ®LVï¼šç´¢å¼•ç¼“å­˜æ•°æ®çš„å…ƒæ•°æ®å­˜å‚¨çš„åœ°æ–¹ï¼Œæˆ‘ä¹Ÿå°†åœ¨SSDä¸Šåˆ›å»ºå®ƒã€‚</p>
</li>
</ul>
</li>
<li>
<p>è¿˜æœ‰é¢å¤–çš„å¤‡ç”¨æ± å…ƒæ•°æ®LVï¼Œåæ–‡é‡åˆ°æ—¶å†ä½œä»‹ç»ã€‚</p>
</li>
</ul>
<p>å¦‚æœç›´æ¥åœ¨PVEçš„WEBUIä¸­æ¥åˆ›å»ºï¼Œæ— æ³•å®ç°æˆ‘æ‰€è®¾æƒ³çš„æ€è·¯ï¼Œæ‰€ä»¥åªèƒ½é€šè¿‡å‘½ä»¤è¡Œæ¥åˆ›å»ºï¼Œç„¶åå†ç»è¿‡å¤šæ¬¡è½¬æ¢ï¼Œæ¥è½¬æ¢ä¸ºæˆ‘æ‰€éœ€è¦çš„LVM-thinã€‚</p>
<h3 id="å…ˆçœ‹çœ‹ç£ç›˜çš„è¯†åˆ«æƒ…å†µ">å…ˆçœ‹çœ‹ç£ç›˜çš„è¯†åˆ«æƒ…å†µ
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">lsblk
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä»è¾“å‡ºå¯è§ï¼Œ/dev/sdbå’Œ/dev/sdcæ˜¯ä¸¤å—HDDï¼Œ/dev/sddå’Œ/dev/sdeæ˜¯ä¸¤å—SSDï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">sda            8:0    0    32G  0 disk 
</span></span><span class="line"><span class="cl">â”œâ”€sda1         8:1    0  1007K  0 part 
</span></span><span class="line"><span class="cl">â”œâ”€sda2         8:2    0   512M  0 part 
</span></span><span class="line"><span class="cl">â””â”€sda3         8:3    0  31.5G  0 part 
</span></span><span class="line"><span class="cl">  â”œâ”€pve-swap 253:0    0     2G  0 lvm  [SWAP]
</span></span><span class="line"><span class="cl">  â””â”€pve-root 253:1    0  29.5G  0 lvm  /
</span></span><span class="line"><span class="cl">sdb            8:16   0   1.8T  0 disk 
</span></span><span class="line"><span class="cl">sdc            8:32   0   1.8T  0 disk 
</span></span><span class="line"><span class="cl">sdd            8:48   0 111.8G  0 disk 
</span></span><span class="line"><span class="cl">sde            8:64   0 111.8G  0 disk
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="å¯¹ç£ç›˜åˆå§‹åŒ–">å¯¹ç£ç›˜åˆå§‹åŒ–
</h3><p>ç»™2å—SSDã€2å—HDDç£ç›˜å…¨éƒ¨ä»¥GPTè¿›è¡Œåˆå§‹åŒ–ï¼Œæ¯ä¸ªç£ç›˜åªåˆ†ä¸€ä¸ªåŒºï¼Œä»¥ä¸‹ä»¥<code>/dev/sdb</code>ä¸ºä¾‹ï¼ˆä¸åˆ†åŒºç›´æ¥åˆ›å»ºæ•´ç›˜PVä¹Ÿå¯ä»¥ï¼‰ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1">## è¿›å…¥fdiskå‘½ä»¤è¡Œ</span>
</span></span><span class="line"><span class="cl">fdisk /dev/sdb
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## åˆ†åˆ«æŒ‰gã€nï¼Œsectoré‡‡ç”¨é»˜è®¤çš„å€¼ç›´æ¥å›è½¦ï¼Œæœ€å wq ä¿å­˜å¹¶é€€å‡º</span>
</span></span><span class="line"><span class="cl">Command <span class="o">(</span>m <span class="k">for</span> <span class="nb">help</span><span class="o">)</span>: g
</span></span><span class="line"><span class="cl">Created a new GPT disklabel <span class="o">(</span>GUID: 798FC3B9-A99E-B245-9A2E-C02B9A2D0836<span class="o">)</span>.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Command <span class="o">(</span>m <span class="k">for</span> <span class="nb">help</span><span class="o">)</span>: n
</span></span><span class="line"><span class="cl">Partition number <span class="o">(</span>1-128, default 1<span class="o">)</span>: 
</span></span><span class="line"><span class="cl">First sector <span class="o">(</span>2048-41943006, default 2048<span class="o">)</span>: 
</span></span><span class="line"><span class="cl">Last sector, +/-sectors or +/-size<span class="o">{</span>K,M,G,T,P<span class="o">}</span> <span class="o">(</span>2048-41943006, default 41943006<span class="o">)</span>: 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Created a new partition <span class="m">1</span> of <span class="nb">type</span> <span class="s1">&#39;Linux filesystem&#39;</span> and of size <span class="m">20</span> GiB.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Command <span class="o">(</span>m <span class="k">for</span> <span class="nb">help</span><span class="o">)</span>: wq
</span></span><span class="line"><span class="cl">The partition table has been altered.
</span></span><span class="line"><span class="cl">Calling ioctl<span class="o">()</span> to re-read partition table.
</span></span><span class="line"><span class="cl">Syncing disks.
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="å…¨éƒ¨åˆ†å¥½åŒºå†è¾“å…¥lsblkæ£€æŸ¥ä¸€ä¸‹">å…¨éƒ¨åˆ†å¥½åŒºå†è¾“å…¥<code>lsblk</code>æ£€æŸ¥ä¸€ä¸‹ï¼š
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">lsblk
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¾“å‡ºï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">NAME         MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT
</span></span><span class="line"><span class="cl">sda            8:0    0    32G  0 disk 
</span></span><span class="line"><span class="cl">â”œâ”€sda1         8:1    0  1007K  0 part 
</span></span><span class="line"><span class="cl">â”œâ”€sda2         8:2    0   512M  0 part 
</span></span><span class="line"><span class="cl">â””â”€sda3         8:3    0  31.5G  0 part 
</span></span><span class="line"><span class="cl">  â”œâ”€pve-swap 253:0    0     2G  0 lvm  [SWAP]
</span></span><span class="line"><span class="cl">  â””â”€pve-root 253:1    0  29.5G  0 lvm  /
</span></span><span class="line"><span class="cl">sdb            8:16   0   1.8T  0 disk 
</span></span><span class="line"><span class="cl">â””â”€sdb1         8:17   0   1.8T  0 part 
</span></span><span class="line"><span class="cl">sdc            8:32   0   1.8T  0 disk 
</span></span><span class="line"><span class="cl">â””â”€sdc1         8:33   0   1.8T  0 part 
</span></span><span class="line"><span class="cl">sdd            8:48   0 111.8G  0 disk 
</span></span><span class="line"><span class="cl">â””â”€sdd1         8:49   0 111.8G  0 part 
</span></span><span class="line"><span class="cl">sde            8:64   0 111.8G  0 disk 
</span></span><span class="line"><span class="cl">â””â”€sde1         8:65   0 111.8G  0 part
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="åˆ›å»ºpv">åˆ›å»ºPV
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">pvcreate /dev/sdb1 /dev/sdc1 /dev/sdd1 /dev/sde1
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¾“å‡ºï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">  Physical volume &#34;/dev/sdb1&#34; successfully created.
</span></span><span class="line"><span class="cl">  Physical volume &#34;/dev/sdc1&#34; successfully created.
</span></span><span class="line"><span class="cl">  Physical volume &#34;/dev/sdd1&#34; successfully created.
</span></span><span class="line"><span class="cl">  Physical volume &#34;/dev/sde1&#34; successfully created.
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="åˆ›å»ºvg">åˆ›å»ºVG
</h3><p>é‡‡ç”¨é»˜è®¤çš„4Må¤§å°çš„PEï¼Œåˆ›å»ºåå«<code>hybrid</code>çš„VGï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">vgcreate hybrid /dev/sdb1 /dev/sdc1 /dev/sdd1 /dev/sde1
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¾“å‡ºï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">  Volume group &#34;hybrid&#34; successfully created
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="åˆ›å»ºæ•°æ®lv">åˆ›å»ºæ•°æ®LV
</h3><p>ç»™ä¸¤å—HDDç»„raid0ï¼Œç”¨å®Œå®ƒä»¬çš„å…¨éƒ¨ç©ºé—´åˆ›å»ºåå«<code>data</code>çš„æ•°æ®LVï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">lvcreate --type raid0 --name data --extents 100%FREE --stripesize 256k hybrid /dev/sdb1 /dev/sdc1
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¾“å‡ºï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">  Logical volume &#34;data&#34; created.
</span></span></code></pre></td></tr></table>
</div>
</div><p>RAIDçš„Stripe Sizeå¤§å°å¯ä»¥è®¾ç½®ä¸º8KiBã€16KiBã€32KiBã€64KiBã€128KiBå’Œ256KiBï¼Œå¦‚ä¸è®¾ç½®æ­¤å‚æ•°åˆ™é»˜è®¤é‡‡ç”¨64KiBã€‚</p>
<blockquote>
<p>å¯¹äºæ•°æ®åº“åº”ç”¨ï¼ŒStripe Sizeåœ¨4-16KiBä¹‹é—´è¢«è¯æ˜æ•ˆæœæ¯”è¾ƒå¥½ï¼›å¯¹äºWebæœåŠ¡å™¨ä»¥åŠæ–‡ä»¶æ‰“å°æœåŠ¡å™¨ï¼Œå»ºè®®Stripe Sizeè®¾ç½®ä¸º16-64KiBï¼›å¯¹äºå¤§æ–‡ä»¶ç¯å¢ƒï¼Œæ¯”å¦‚æµåª’ä½“ï¼Œå»ºè®®Stripe Sizeè®¾ç½®ä¸º128KiBä»¥ä¸Šã€‚</p>
</blockquote>
<p>æˆ‘çš„ä¸»è¦æ˜¯å¤§æ–‡ä»¶ï¼Œæ‰€ä»¥æˆ‘è®¾ç½®Stripe Sizeä¸º256KiBã€‚å¹¶ä¸”æˆ‘çš„ä½¿ç”¨åœºæ™¯ä¸‹ï¼Œä¸»è¦ç›®çš„æ˜¯æå‡IOï¼Œåè€Œå¯¹æ•°æ®æŸåè¿™ä¸ªæƒ…å†µä¸å…³å¿ƒï¼Œåäº†å°±åäº†ï¼Œæ‰€ä»¥æˆ‘é‡‡ç”¨çš„æ˜¯raid0ï¼Œå’Œæˆ‘ä½¿ç”¨åœºæ™¯ä¸ä¸€è‡´çš„ä¸è¦é‡‡ç”¨raid0ä»¥åŠ256KiBçš„Stripe Sizeã€‚</p>
<h3 id="åˆ›å»ºå…ƒæ•°æ®lvå’Œç¼“å­˜æ± å…ƒæ•°æ®lv">åˆ›å»ºå…ƒæ•°æ®LVå’Œç¼“å­˜æ± å…ƒæ•°æ®LV
</h3><ul>
<li>
<p>æˆ‘æœ€ç»ˆè¦åˆ›å»ºçš„å­˜å‚¨ç±»å‹æ˜¯LVM-thinï¼Œè¿™ç§è–„å­˜å‚¨ç±»å‹éœ€è¦å¦å¤–çš„ç©ºé—´å­˜å‚¨å…ƒæ•°æ®metadataï¼Œå¦‚æœç›´æ¥åœ¨HDDä¸Šåˆ›å»ºLVM-thinï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨åœ¨HDDä¸Šåˆ›å»ºå…¶å¯¹åº”çš„å…ƒæ•°æ®LVã€‚ä½†æˆ‘ä»¬ç°åœ¨åˆ›å»ºçš„æ˜¯raid0ç±»å‹çš„LVMï¼Œé»˜è®¤ä¸å¸¦å…ƒæ•°æ®LVï¼Œå¹¶ä¸”å¦ä¸€æ–¹é¢ï¼Œæˆ‘å¸Œæœ›èƒ½åœ¨SSDä¸Šåˆ›å»ºå…ƒæ•°æ®æ‰€éœ€è¦çš„LVï¼Œè¿™æ ·è¿˜å¯ä»¥æå‡æ•°æ®ç´¢å¼•é€Ÿåº¦ï¼Œæ‰€ä»¥æˆ‘éœ€è¦æ‰‹åŠ¨åœ¨SSDä¸Šåˆ›å»ºæœ€ç»ˆçš„LVM-thinå­˜å‚¨æ‰€éœ€è¦çš„å…ƒæ•°æ®LVã€‚</p>
</li>
<li>
<p>å¹¶ä¸”ï¼Œæˆ‘ä»¬åé¢å°†SSDä½œä¸ºç¼“å­˜æ± cachepoolæ—¶ï¼Œç¼“å­˜æ± å®ƒæœ¬èº«ä¹Ÿéœ€è¦å­˜å‚¨å…ƒæ•°æ®ï¼Œæ‰€ä»¥è¿™é‡Œä¹Ÿéœ€è¦ä¸ºç¼“å­˜æ± åˆ›å»ºç¼“å­˜æ± å…ƒæ•°æ®LVã€‚</p>
</li>
<li>
<p>å¦å¤–ï¼Œæˆ‘æœ‰ä¸¤å—SSDï¼Œæˆ‘å¸Œæœ›èƒ½æœ€å¤§åŒ–çš„æå‡IOï¼Œæ‰€ä»¥è¿™ä¸¤å—SSDä¹‹é—´ä¹Ÿéœ€è¦ç»„raid0ã€‚</p>
</li>
</ul>
<p>é¦–å…ˆä¸ºæœ€ç»ˆè¦åˆ›å»ºçš„LVM-thinå­˜å‚¨åˆ›å»ºåå«<code>meta_thinpool</code>çš„å…ƒæ•°æ®LVï¼Œåˆ›å»ºæ—¶å®ƒé»˜è®¤æ˜¯æ•°æ®LVå¤§å°çš„0.1%ï¼Œæˆ‘å–çº¦0.3%ï¼Œåˆ›å»º11.5GiBçš„å…ƒæ•°æ®LVï¼ˆä¸èƒ½è¶…è¿‡15.81GiBï¼‰ã€‚</p>
<p>å­˜å‚¨å…ƒæ•°æ®çš„raid0ç»„Stripe Sizeæˆ‘å°±ä¿æŒé»˜è®¤çš„64KiBå§ï¼ˆä¸æ·»åŠ &ndash;stripesizeå³ä½¿ç”¨é»˜è®¤å€¼ï¼‰ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">lvcreate --type raid0 --name meta_thinpool --size 11.5G hybrid /dev/sdd1 /dev/sde1
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¾“å‡º</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">  Using default stripesize 64.00 KiB.
</span></span><span class="line"><span class="cl">  Logical volume &#34;meta_thinpool&#34; created.
</span></span></code></pre></td></tr></table>
</div>
</div><p>å†ä¸ºåé¢é©¬ä¸Šè¦åˆ›å»ºçš„çš„ç¼“å­˜æ± LVåˆ›å»ºåå«<code>meta_cachepool</code>çš„ç¼“å­˜æ± å…ƒæ•°æ®LVï¼Œraid0ç»„ä¹Ÿä½¿ç”¨é»˜è®¤çš„Stripe Sizeï¼Œå¤§å°å°±å–528Mï¼ˆå¤§çº¦ä¹Ÿæ˜¯ç¼“å­˜æ± LVçš„0.3%ï¼‰å§ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">lvcreate --type raid0 --name meta_cachepool --size 528M hybrid /dev/sdd1 /dev/sde1
</span></span></code></pre></td></tr></table>
</div>
</div><p><em>æœ‰å…³å…ƒæ•°æ®LVå¤§å°åº”è¯¥è®¾ç½®å¤šå¤§ï¼Œå¯ä»¥æŸ¥çœ‹å®˜æ–¹å»ºè®®ï¼š<a class="link" href="https://man.archlinux.org/man/lvmthin.7.en#Size_of_pool_metadata_LV"  target="_blank" rel="noopener"
    >lvmthin.7.en#Size_of_pool_metadata_LV</a></em></p>
<p>è¾“å‡º</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">  Using default stripesize 64.00 KiB.
</span></span><span class="line"><span class="cl">  Logical volume &#34;meta_cachepool&#34; created.
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="åˆ›å»ºç¼“å­˜æ± æ•°æ®lv">åˆ›å»ºç¼“å­˜æ± æ•°æ®LV
</h3><p>åœ¨SSDä¸Šå·²ç»åˆ›å»ºå¥½äº†ä¸¤ä¸ªmetadataçš„LVï¼Œå äº†ä¸€ç‚¹ç©ºé—´ï¼Œä¸ºäº†æœ€å¤§åŒ–åˆ©ç”¨ç£ç›˜ç©ºé—´ï¼Œå…ˆæŠŠä¸¤å—SSDä½™ä¸‹çš„ç©ºé—´å…¨éƒ¨åˆ†é…ç»™ç¼“å­˜æ± æ•°æ®LVã€‚ä¸è¿‡å¦‚æœåç»­è¿›è¡Œlvconvertè½¬æ¢å­˜å‚¨ç±»å‹æ“ä½œæ—¶ï¼Œå¦‚æœªè®¾ç½®å…³é—­è‡ªåŠ¨åˆ›å»ºå¤‡ç”¨æ± å…ƒæ•°æ®LVï¼ˆå³å‘½ä»¤ä¸­æ·»åŠ <code>--poolmetadataspare n</code>ï¼Œåœ¨PVEçš„WEBUIä¸­åˆ›å»ºLVM-thinï¼Œç³»ç»Ÿä¹Ÿä¼šé»˜è®¤åˆ›å»ºå¤‡ç”¨æ± å…ƒæ•°æ®LVï¼‰ï¼Œåœ¨è¿›è¡Œè½¬æ¢æ“ä½œæ—¶å°±éœ€è¦é¢å¤–çš„ç­‰åŒäº<code>hybrid/meta_thinpool</code>å¤§å°ï¼ˆæˆ‘è¿™é‡Œå°±æ˜¯11.5GiBï¼‰çš„ç©ºé—´ã€‚æˆ‘æ‰“ç®—è®©å…¶è‡ªåŠ¨åˆ›å»ºå¤‡ç”¨æ± å…ƒæ•°æ®LVï¼Œæ‰€ä»¥æˆ‘éœ€è¦é¢„ç•™11.5GiBï¼ˆå³2944ä¸ªPEï¼‰ã€‚</p>
<p><strong>å¦‚æœå·²ç»åœ¨LVM-thinåˆ›å»ºäº†è™šæ‹Ÿç£ç›˜ï¼Œæ²¡æœ‰ä»»ä½•å‰©ä½™ç©ºé—´çš„è¯ï¼Œåç»­å†è°ƒæ•´å°±ä¸å¤ªå¥½è°ƒæ•´äº†ï¼Œæ‰€ä»¥å¦‚æœä¸å¤ªæ”¾å¿ƒçš„è¯ï¼Œä½ å¤šä¿ç•™ä¸€äº›ç©ºé—´ä¸å®Œå…¨åˆ›å»ºLVä¹Ÿæ˜¯å¯ä»¥çš„ã€‚</strong></p>
<p>ä¸ºäº†æœ€å¤§åŒ–çš„æå‡IOæ€§èƒ½ï¼Œç¼“å­˜æ± ä¹Ÿé‡‡ç”¨raid0ã€‚åŒæ ·é‡‡ç”¨é»˜è®¤çš„Stripe Sizeã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1">## å…ˆæ£€æŸ¥ä¸€ä¸‹hybridè¿™ä¸ªVGè¿˜å‰©ä¸‹å¤šå°‘ä¸ªPE</span>
</span></span><span class="line"><span class="cl">vgdisplay hybrid
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## ä»è¾“å‡ºå¯ä»¥çœ‹å‡ºè¿˜å‰©ä¸‹54144ä¸ªPE</span>
</span></span><span class="line"><span class="cl">  --- Volume group ---
</span></span><span class="line"><span class="cl">  VG Name               hybrid
</span></span><span class="line"><span class="cl">  System ID             
</span></span><span class="line"><span class="cl">  Format                lvm2
</span></span><span class="line"><span class="cl">  Metadata Areas        <span class="m">4</span>
</span></span><span class="line"><span class="cl">  Metadata Sequence No  <span class="m">4</span>
</span></span><span class="line"><span class="cl">  VG Access             read/write
</span></span><span class="line"><span class="cl">  VG Status             resizable
</span></span><span class="line"><span class="cl">  MAX LV                <span class="m">0</span>
</span></span><span class="line"><span class="cl">  Cur LV                <span class="m">3</span>
</span></span><span class="line"><span class="cl">  Open LV               <span class="m">0</span>
</span></span><span class="line"><span class="cl">  Max PV                <span class="m">0</span>
</span></span><span class="line"><span class="cl">  Cur PV                <span class="m">4</span>
</span></span><span class="line"><span class="cl">  Act PV                <span class="m">4</span>
</span></span><span class="line"><span class="cl">  VG Size               &lt;3.86 TiB
</span></span><span class="line"><span class="cl">  PE Size               4.00 MiB
</span></span><span class="line"><span class="cl">  Total PE              <span class="m">1010894</span>
</span></span><span class="line"><span class="cl">  Alloc PE / Size       <span class="m">956750</span> / &lt;3.65 TiB
</span></span><span class="line"><span class="cl">  Free  PE / Size       <span class="m">54144</span> / 211.50 GiB
</span></span><span class="line"><span class="cl">  VG UUID               13c6EC-n2E4-nQvh-hD5J-q8F1-Hl73-77pkji
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## ä¸ºåé¢çš„è½¬æ¢é¢„ç•™2944ä¸ªPEå³11.5GiBç”¨ä½œå¤‡ç”¨æ± å…ƒæ•°æ®LVï¼Œå…¶ä»–çš„å…±51200ä¸ªPEåˆ›å»ºç¼“å­˜æ± æ•°æ®LV</span>
</span></span><span class="line"><span class="cl">lvcreate --type raid0 --name cache --extents <span class="m">51200</span> hybrid /dev/sdd1 /dev/sde1
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## è¾“å‡º</span>
</span></span><span class="line"><span class="cl">  Using default stripesize 64.00 KiB.
</span></span><span class="line"><span class="cl">  Logical volume <span class="s2">&#34;cache&#34;</span> created.
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="è½¬æ¢å­˜å‚¨ç±»å‹">è½¬æ¢å­˜å‚¨ç±»å‹
</h3><ol>
<li>è½¬æ¢<code>hybrid/cache</code>è¿™ä¸ªLVçš„ç±»å‹ä¸ºç¼“å­˜æ± <code>cache-pool</code>ï¼Œè®¾ç½®<code>chunksize</code>ä¸º256KiBï¼ŒæŒ‡å®šç¼“å­˜æ± å…ƒæ•°æ®LVä¸ºä¹‹å‰å·²ç»åœ¨SSDä¸Šä»¥raid0åˆ›å»ºçš„<code>hybrid/meta_cachepool</code>ï¼š</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">lvconvert --type cache-pool --poolmetadata hybrid/meta_cachepool --chunksize <span class="m">256</span> hybrid/cache
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™ä¸€æ­¥æ“ä½œä¸­<code>chunksize</code>çš„å€¼åº”è¯¥å‚è€ƒä¸‹æ–¹è¯´æ˜ä¸­<code>lvmcache</code>æœ‰å…³çš„è¯´æ˜è¿›è¡Œè®¾ç½®ã€‚è¾“å‡ºå¦‚ä¸‹ï¼Œè¿™æ ·ï¼Œç¼“å­˜æ± å…ƒæ•°æ®LV<code>hybrid/meta_cachepool</code>å’Œç¼“å­˜æ± æ•°æ®LV<code>hybrid/cache</code>å°±åˆå¹¶æˆæ–°çš„ç¼“å­˜æ± LVäº†ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">  WARNING: Converting hybrid/cache and hybrid/meta_cachepool to cache pool&#39;s data and metadata volumes with metadata wiping.
</span></span><span class="line"><span class="cl">  THIS WILL DESTROY CONTENT OF LOGICAL VOLUME (filesystem etc.)
</span></span><span class="line"><span class="cl">Do you really want to convert hybrid/cache and hybrid/meta_cachepool? [y/n]: y
</span></span><span class="line"><span class="cl">  Converted hybrid/cache and hybrid/meta_cachepool to cache pool.
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>æœ‰å…³chunksizeçš„è¯´æ˜</strong></p>
<blockquote>
<p><em>The size of chunks in a snapshot, cache pool or thin pool. For snapshots, the value must be a power of 2 between 4KiB and 512KiB and the default value is 4. For a cache pool the value must be between 32KiB and 1GiB and the default value is 64. For a thin pool the value must be between 64KiB and 1GiB and the default value starts with 64 and scales up to fit the pool metadata size within 128MiB, if the pool metadata size is not specified. The value must be a multiple of 64KiB. See lvmthin(7) and lvmcache(7) for more information.</em>
æœºç¿»ï¼šå¿«ç…§ã€ç¼“å­˜æ± æˆ–ç²¾ç®€æ± ä¸­çš„å—å¤§å°ã€‚å¯¹äºå¿«ç…§ï¼Œè¯¥å€¼å¿…é¡»æ˜¯2çš„å¹‚ï¼Œä»‹äº4KBå’Œ512KBä¹‹é—´ï¼Œé»˜è®¤å€¼ä¸º4ã€‚å¯¹äºç¼“å­˜æ± ï¼Œè¯¥å€¼é¡»ä»‹äº32KiBå’Œ1GiBä¹‹é—´ï¼Œå¹¶ä¸”é»˜è®¤å€¼ä¸º64ã€‚å¯¹äºç²¾ç®€æ± ï¼Œè¯¥æ•°å€¼å¿…é¡»ä»‹äº64KiBå’Œ1GiBä¹‹é—´ï¼Œå¦‚æœæœªæŒ‡å®šæ± å…ƒæ•°æ®å¤§å°ï¼Œåˆ™é»˜è®¤å€¼ä»64å¼€å§‹ï¼Œå¹¶æŒ‰æ¯”ä¾‹æ”¾å¤§ä»¥é€‚åº”128MiBå†…çš„æ± å…ƒæ•°æ®å¤§å°ã€‚è¯¥å€¼å¿…é¡»æ˜¯64KiBçš„å€æ•°ã€‚æœ‰å…³æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚è§<a class="link" href="https://man.archlinux.org/man/lvmthin.7.en#Chunk_size"  target="_blank" rel="noopener"
    >lvmthin</a>å’Œ<a class="link" href="https://man.archlinux.org/man/lvmcache.7.en#dm-cache_chunk_size"  target="_blank" rel="noopener"
    >lvmcache</a>ã€‚</p>
</blockquote>
<p>lvmthinï¼š</p>
<blockquote>
<p>When a thin pool is used primarily for the thin provisioning feature, a larger value is optimal. To optimize for many snapshots, a smaller value reduces copying time and consumes less space.
æœºç¿»ï¼šå½“ç²¾ç®€æ± ä¸»è¦ç”¨äºç²¾ç®€èµ„æºè°ƒé…åŠŸèƒ½æ—¶ï¼Œæœ€å¥½ä½¿ç”¨è¾ƒå¤§çš„å€¼ã€‚è¦ä¼˜åŒ–å¤šä¸ªå¿«ç…§ï¼Œè¾ƒå°çš„å€¼å¯ä»¥å‡å°‘å¤åˆ¶æ—¶é—´å¹¶æ¶ˆè€—æ›´å°‘çš„ç©ºé—´ã€‚</p>
</blockquote>
<p>lvmcacheï¼š</p>
<blockquote>
<p>Using a chunk size that is too large can result in wasteful use of the cache, in which small reads and writes cause large sections of an LV to be stored in the cache. It can also require increasing migration threshold which defaults to 2048 sectors (1 MiB). Lvm2 ensures migration threshold is at least 8 chunks in size. This may in some cases result in very high bandwidth load of transfering data between the cache LV and its cache origin LV. However, choosing a chunk size that is too small can result in more overhead trying to manage the numerous chunks that become mapped into the cache. Overhead can include both excessive CPU time searching for chunks, and excessive memory tracking chunks.
æœºç¿»ï¼šä½¿ç”¨è¿‡å¤§çš„å—å¤§å°å¯èƒ½ä¼šå¯¼è‡´ç¼“å­˜çš„æµªè´¹ä½¿ç”¨ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¾ƒå°çš„è¯»å–å’Œå†™å…¥ä¼šå¯¼è‡´LVçš„è¾ƒå¤§éƒ¨åˆ†å­˜å‚¨åœ¨ç¼“å­˜ä¸­ã€‚å®ƒè¿˜å¯èƒ½éœ€è¦å¢åŠ è¿ç§»é˜ˆå€¼ï¼Œé»˜è®¤ä¸º2048ä¸ªæ‰‡åŒºï¼ˆ1ä¸ªMiBï¼‰ã€‚Lvm2ç¡®ä¿è¿ç§»é˜ˆå€¼çš„å¤§å°è‡³å°‘ä¸º8ä¸ªå—ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œè¿™å¯èƒ½å¯¼è‡´åœ¨é«˜é€Ÿç¼“å­˜LVä¸å…¶é«˜é€Ÿç¼“å­˜æºLVä¹‹é—´ä¼ è¾“æ•°æ®çš„éå¸¸é«˜çš„å¸¦å®½è´Ÿè½½ã€‚ç„¶è€Œï¼Œé€‰æ‹©å¤ªå°çš„å—å¤§å°å¯èƒ½ä¼šå¯¼è‡´ç®¡ç†æ˜ å°„åˆ°ç¼“å­˜ä¸­çš„å¤§é‡å—çš„æ›´å¤šå¼€é”€ã€‚å¼€é”€å¯èƒ½åŒ…æ‹¬è¿‡å¤šçš„CPUæ—¶é—´æœç´¢å—ï¼Œä»¥åŠè¿‡å¤šçš„å†…å­˜è·Ÿè¸ªå—ã€‚</p>
</blockquote>
<ol start="2">
<li>æŠŠä¹‹å‰åœ¨HDDä¸Šåˆ›å»ºçš„<code>hybrid/data</code>è¿™ä¸ªLVçš„ç±»å‹è½¬æ¢ä¸ºå¸¦ç¼“å­˜æ± LVï¼ˆ<code>hybrid/cache</code>ï¼‰çš„å­˜å‚¨ç±»å‹ï¼ŒæŒ‡å®šç¼“å­˜æ± ä¸ºåˆšåˆšåˆå¹¶åçš„ç¼“å­˜æ± LV<code>hybrid/cache</code>ï¼Œè®¾ç½®ç¼“å­˜æ¨¡å¼ä¸º<code>writeback</code>ï¼š</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">lvconvert --type cache --cachepool hybrid/cache --cachemode writeback hybrid/data
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¾“å‡ºå¦‚ä¸‹ï¼Œè¿™æ ·ï¼Œæ•°æ®LV<code>hybrid/data</code>å°±å’Œç¼“å­˜æ± LV<code>hybrid/cache</code>åˆå¹¶æˆæ–°çš„å¸¦ç¼“å­˜æ± çš„LVMå­˜å‚¨<code>hybrid/data</code>äº†ï¼Œè¿™ä¸ªæ—¶å€™å®ƒè¿˜ä¸æ˜¯LVM-thinå­˜å‚¨ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Do you want wipe existing metadata of cache pool hybrid/cache? [y/n]: y
</span></span><span class="line"><span class="cl">  WARNING: Data redundancy could be lost with writeback caching of raid logical volume!
</span></span><span class="line"><span class="cl">  Logical volume hybrid/data is now cached.
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç¼“å­˜æ¨¡å¼å¯é€‰æ‹©å¦‚ä¸‹ï¼Œæˆ‘éƒ½raid0äº†ï¼Œå·²ç»æ— æ‰€ç•æƒ§äº†ï¼Œæ‰€ä»¥æˆ‘é€‰æ‹©<code>writeback</code>ï¼Œæ•°æ®ä¸¢äº†å°±ä¸¢äº†å§ï¼š</p>
<blockquote>
<p><strong>writeback</strong>: writeback considers a write complete as soon as it is stored in the cache pool.</p>
</blockquote>
<blockquote>
<p><strong>writethough</strong>: writethough considers a write complete only when it has been stored in both the cache pool and on the origin LV. While writethrough may be slower for writes, it is more resilient if something should happen to a device associated with the cache pool LV.</p>
</blockquote>
<blockquote>
<p><strong>passthrough</strong>: With passthrough, all reads are served from the origin LV (all reads miss the cache) and all writes are forwarded to the origin LV; additionally, write hits cause cache block invalidates. See lvmcache(7) for more information.</p>
</blockquote>
<ol start="3">
<li>å†æŠŠåˆšåˆšåˆå¹¶çš„å¸¦ç¼“å­˜æ± çš„LVMå­˜å‚¨<code>hybrid/data</code>ä¸ä¹‹å‰åˆ›å»ºçš„å…ƒæ•°æ®LV<code>hybrid/meta_thinpool</code>åˆå¹¶è½¬æ¢ä¸ºæœ€ç»ˆéœ€è¦çš„LVM-thinå­˜å‚¨ï¼š</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">lvconvert --type thin-pool --poolmetadata hybrid/meta_thinpool hybrid/data
</span></span></code></pre></td></tr></table>
</div>
</div><p>æœ‰å…³<code>chunksize</code>çš„å…·ä½“è¯´æ˜è§ä¸Šæ–¹ï¼Œè¿™ä¸€æ­¥æ“ä½œä¸­<code>chunksize</code>çš„å€¼åº”è¯¥å‚è€ƒä¸Šæ–¹è¯´æ˜ä¸­<code>lvmthin</code>æœ‰å…³çš„è¯´æ˜è¿›è¡Œè®¾ç½®ã€‚å¦‚é‡‡ç”¨é»˜è®¤64KiBçš„chunksizeï¼Œæœ€å¤§å¯æ”¯æŒ15.81TiBçš„LVM-thinã€‚æˆ‘çš„è¾“å‡ºå¦‚ä¸‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">  Thin pool volume with chunk size 64.00 KiB can address at most 15.81 TiB of data.
</span></span><span class="line"><span class="cl">  WARNING: Converting hybrid/data and hybrid/meta_thinpool to thin pool&#39;s data and metadata volumes with metadata wiping.
</span></span><span class="line"><span class="cl">  THIS WILL DESTROY CONTENT OF LOGICAL VOLUME (filesystem etc.)
</span></span><span class="line"><span class="cl">Do you really want to convert hybrid/data and hybrid/meta_thinpool? [y/n]: y
</span></span><span class="line"><span class="cl">  Converted hybrid/data and hybrid/meta_thinpool to thin pool.
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="æ£€æŸ¥">æ£€æŸ¥
</h2><p>æœ€åï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹LVå’Œç‰©ç†ç£ç›˜çš„æƒ…å†µ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">lvs -a -o lv_full_name,parent,lv_size,modules,devices
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¾“å‡ºå¦‚ä¸‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">LV                                Parent              LSize   Modules              Devices                                                    
</span></span><span class="line"><span class="cl">hybrid/cache_cpool                                    200.00g cache,raid           cache_cpool_cdata(0)                                       
</span></span><span class="line"><span class="cl">hybrid/cache_cpool_cdata          [cache_cpool]       200.00g raid                 cache_cpool_cdata_rimage_0(0),cache_cpool_cdata_rimage_1(0)
</span></span><span class="line"><span class="cl">hybrid/cache_cpool_cdata_rimage_0 [cache_cpool_cdata] 100.00g                      /dev/sdd1(1538)                                            
</span></span><span class="line"><span class="cl">hybrid/cache_cpool_cdata_rimage_1 [cache_cpool_cdata] 100.00g                      /dev/sde1(1538)                                            
</span></span><span class="line"><span class="cl">hybrid/cache_cpool_cmeta          [cache_cpool]       528.00m raid                 cache_cpool_cmeta_rimage_0(0),cache_cpool_cmeta_rimage_1(0)
</span></span><span class="line"><span class="cl">hybrid/cache_cpool_cmeta_rimage_0 [cache_cpool_cmeta] 264.00m                      /dev/sdd1(0)                                               
</span></span><span class="line"><span class="cl">hybrid/cache_cpool_cmeta_rimage_1 [cache_cpool_cmeta] 264.00m                      /dev/sde1(0)                                               
</span></span><span class="line"><span class="cl">hybrid/data                                            &lt;3.64t cache,raid,thin-pool data_tdata(0)                                              
</span></span><span class="line"><span class="cl">hybrid/data_tdata                 data                 &lt;3.64t cache,raid           data_tdata_corig(0)                                        
</span></span><span class="line"><span class="cl">hybrid/data_tdata_corig                                &lt;3.64t raid                 data_tdata_corig_rimage_0(0),data_tdata_corig_rimage_1(0)  
</span></span><span class="line"><span class="cl">hybrid/data_tdata_corig_rimage_0  [data_tdata_corig]   &lt;1.82t                      /dev/sdb1(0)                                               
</span></span><span class="line"><span class="cl">hybrid/data_tdata_corig_rimage_1  [data_tdata_corig]   &lt;1.82t                      /dev/sdc1(0)                                               
</span></span><span class="line"><span class="cl">hybrid/data_tmeta                 data                 11.50g raid                 data_tmeta_rimage_0(0),data_tmeta_rimage_1(0)              
</span></span><span class="line"><span class="cl">hybrid/data_tmeta_rimage_0        [data_tmeta]          5.75g                      /dev/sdd1(66)                                              
</span></span><span class="line"><span class="cl">hybrid/data_tmeta_rimage_1        [data_tmeta]          5.75g                      /dev/sde1(66)                                              
</span></span><span class="line"><span class="cl">hybrid/lvol0_pmspare                                   11.50g                      /dev/sdd1(27138)                                           
</span></span><span class="line"><span class="cl">hybrid/lvol0_pmspare                                   11.50g                      /dev/sde1(27138)                                           
</span></span><span class="line"><span class="cl">pve/root                                              &lt;29.50g                      /dev/sda3(512)                                             
</span></span><span class="line"><span class="cl">pve/swap                                                2.00g                      /dev/sda3(0) 
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä»è¾“å‡ºä¸­çš„<code>Layout</code>å’Œ<code>Devices</code>å­—æ®µå¯ä»¥çœ‹å‡ºï¼Œ<code>hybrid/data</code>è¿™ä¸ªç»¼åˆäº†raid0ã€ç¼“å­˜æ± å’Œå…·æœ‰thinåŠŸèƒ½çš„LVM-thinï¼Œå†…éƒ¨çš„å„ä¸ªä¸‹çº§LVï¼š</p>
<ol>
<li>
<p>å®ƒçš„æ•°æ®LV<code>data_tdata</code>å¤§å°æ˜¯3.64TiBï¼Œå…¶å®å°±æ˜¯ä¸¤å—HDDå¤§å°ä¹‹å’Œï¼ˆ2Tç›˜çš„å®é™…å¤§å°æ˜¯1.82TiBï¼‰ï¼Œå®ƒçš„åŸå§‹ï¼ˆorigï¼‰æ•°æ®LVæ˜¯<code>data_tdata_corig</code>ï¼Œè€Œ<code>data_tdata_corig</code>æ˜¯ç”±ä¸¤å—HDDçš„<code>/dev/sdb1</code>å’Œ<code>/dev/sdc1</code>åˆ†åŒºç»„çš„raid0ï¼ˆ<code>data_tdata_corig_rimage_0</code>å’Œ<code>data_tdata_corig_rimage_1</code>ï¼‰ï¼›</p>
</li>
<li>
<p>å®ƒæ‰€éœ€è¦çš„å…ƒæ•°æ®LVï¼ˆå³<code>data_tmeta</code>ï¼‰å¤§å°æ˜¯11.5GiBï¼Œä¹Ÿæ˜¯raid0ç»„ï¼Œè¿™ä¸ªraid0ç»„ä½äºä¸¤å—SSDä¸Šï¼Œå³<code>data_tmeta_rimage_0</code>å’Œ<code>data_tmeta_rimage_1</code>ï¼›</p>
</li>
<li>
<p>å®ƒæœ‰ä¸€ä¸ªç¼“å­˜æ± LV<code>cache_cpool</code>ï¼Œè€Œç¼“å­˜æ± LV<code>cache_cpool</code>æœ¬èº«åˆåˆ†ä¸ºæ•°æ®å’Œå…ƒæ•°æ®ä¸¤éƒ¨åˆ†ï¼š</p>
</li>
</ol>
<ul>
<li>
<p>ç¼“å­˜æ± æ•°æ®LVæ˜¯<code>cache_cpool_cdata</code>ï¼Œæ€»å¤§å°200GiBï¼Œæ˜¯ä½äºä¸¤å—SSDä¸Šçš„<code>cache_cpool_cdata_rimage_0</code>å’Œ<code>cache_cpool_cdata_rimage_1</code>ç»„æˆçš„raid0ï¼›</p>
</li>
<li>
<p>ç¼“å­˜æ± å…ƒæ•°æ®LVæ˜¯<code>cache_cpool_cmeta</code>ï¼Œæ€»å¤§å°528MiBï¼Œä¹Ÿæ˜¯ç”±ä½äºä¸¤å—SSDä¸Šçš„<code>cache_cpool_cmeta_rimage_0</code>å’Œ<code>cache_cpool_cmeta_rimage_1</code>ç»„æˆçš„raid0ã€‚</p>
</li>
</ul>
<ol start="4">
<li>è½¬æ¢å­˜å‚¨ç±»å‹è¿˜ç”Ÿæˆäº†<code>lvol0_pmspare</code>ï¼Œè¿™ä¸ªæ˜¯è‡ªåŠ¨åˆ›å»ºçš„å¤‡ç”¨æ± å…ƒæ•°æ®LVï¼Œå¤‡ç”¨æ± å…ƒæ•°æ®LVæ˜¯åœ¨ä¿®å¤æ± æ—¶å¯ä»¥ä½¿ç”¨çš„ä¿ç•™ç©ºé—´ã€‚å®ƒçš„å¤§å°ç­‰åŒäºæœ€å¤§çš„å…ƒæ•°æ®LVå¤§å°ï¼ˆæˆ‘åˆ›å»ºçš„ä¸¤ä¸ªå…ƒæ•°æ®LVä¸­è¾ƒå¤§çš„æ˜¯11.5GiBï¼‰ã€‚å¦‚æƒ³å…³é—­è‡ªåŠ¨åˆ›å»ºè¿™ç§ç±»å‹çš„LVï¼Œéœ€è¦åœ¨ä¸å…ƒæ•°æ®LVæœ‰å…³çš„ä¸¤æ¬¡è½¬æ¢å‘½ä»¤lvconvertä¸­æ·»åŠ <code>--poolmetadataspare n</code>ã€‚å¦‚æœè®¾ç½®äº†ä¸è‡ªåŠ¨åˆ›å»ºï¼Œé‚£ä¹ˆå‰é¢çš„å­˜å‚¨ç±»å‹è½¬æ¢æ—¶ä¹Ÿå°±ä¸éœ€è¦æå‰é¢„ç•™ç©ºé—´ã€‚è™½ç„¶çœ‹èµ·æ¥æœ‰ä¸¤ä¸ªï¼ˆå› ä¸ºæˆ‘è¿›è¡Œäº†ä¸¤æ¬¡ä¸å…ƒæ•°æ®æœ‰å…³çš„è½¬æ¢lvconvertï¼‰ï¼Œä½†å®é™…ä¸Šæ˜¯åœ¨ä¸¤å—SSDä¸Šæ€»å…±å ç”¨11.5GiBï¼Œæ¯å—SSDå„5.75GiBã€‚</li>
</ol>
<p>æ¯å—SSDä¸Šçš„LVæœ‰ï¼šç¼“å­˜æ± æ•°æ®LVï¼ˆcache_cpool_cdataï¼‰100GiBï¼Œç¼“å­˜æ± å…ƒæ•°æ®LVï¼ˆcache_cpool_cmetaï¼‰264MiBï¼Œå…ƒæ•°æ®LVï¼ˆdata_tmetaï¼‰5.75GiBï¼Œå¤‡ç”¨æ± å…ƒæ•°æ®LVï¼ˆlvol0_pmspareï¼‰5.75GiBã€‚ä»¥ä¸Šæ€»è®¡111.76GiBï¼Œè¿™å°±æ˜¯120Gçš„SSDçš„çœŸå®å¤§å°ã€‚</p>
<p>è¿™æ ·ï¼Œå°†<code>å…ƒæ•°æ®LV</code>ã€<code>ç¼“å­˜æ± æ•°æ®LV</code>ã€<code>ç¼“å­˜æ± å…ƒæ•°æ®LV</code>å…¨éƒ¨æ”¾åœ¨SSDä¸Šä»¥æå‡IOæ€§èƒ½ï¼Œä¸¤å—HDDç»„æˆ<code>æ•°æ®LV</code>ä»¥ä¿å­˜åŸå§‹æ•°æ®ï¼Œé‚£ä¹ˆHDDå¤§å°ä¹‹å’Œ3.64TiBå°±æ˜¯è¿™ä¸ªLVM-thinå­˜å‚¨çš„æœ€ç»ˆå¤§å°ã€‚</p>
<p>å†ä»¥å¦å¤–ä¸€ä¸ªè§’åº¦æ¥çœ‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">lsblk
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä»è¾“å‡ºä¹Ÿå¯ä»¥çœ‹åˆ°HDDä¸Šåªæœ‰dataï¼Œä¸¤ä¸ªmetadataå’Œcacheå…¨éƒ¨ä½äºSSDï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">NAME                                  MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT
</span></span><span class="line"><span class="cl">sda                                     8:0    0    32G  0 disk 
</span></span><span class="line"><span class="cl">â”œâ”€sda1                                  8:1    0  1007K  0 part 
</span></span><span class="line"><span class="cl">â”œâ”€sda2                                  8:2    0   512M  0 part 
</span></span><span class="line"><span class="cl">â””â”€sda3                                  8:3    0  31.5G  0 part 
</span></span><span class="line"><span class="cl">  â”œâ”€pve-swap                          253:0    0     2G  0 lvm  [SWAP]
</span></span><span class="line"><span class="cl">  â””â”€pve-root                          253:1    0  29.5G  0 lvm  /
</span></span><span class="line"><span class="cl">sdb                                     8:16   0   1.8T  0 disk 
</span></span><span class="line"><span class="cl">â””â”€sdb1                                  8:17   0   1.8T  0 part 
</span></span><span class="line"><span class="cl">  â””â”€hybrid-data_tdata_corig_rimage_0  253:11   0   1.8T  0 lvm  
</span></span><span class="line"><span class="cl">    â””â”€hybrid-data_tdata_corig         253:13   0   3.6T  0 lvm  
</span></span><span class="line"><span class="cl">      â””â”€hybrid-data_tdata             253:14   0   3.6T  0 lvm  
</span></span><span class="line"><span class="cl">        â””â”€hybrid-data                 253:15   0   3.6T  0 lvm  
</span></span><span class="line"><span class="cl">sdc                                     8:32   0   1.8T  0 disk 
</span></span><span class="line"><span class="cl">â””â”€sdc1                                  8:33   0   1.8T  0 part 
</span></span><span class="line"><span class="cl">  â””â”€hybrid-data_tdata_corig_rimage_1  253:12   0   1.8T  0 lvm  
</span></span><span class="line"><span class="cl">    â””â”€hybrid-data_tdata_corig         253:13   0   3.6T  0 lvm  
</span></span><span class="line"><span class="cl">      â””â”€hybrid-data_tdata             253:14   0   3.6T  0 lvm  
</span></span><span class="line"><span class="cl">        â””â”€hybrid-data                 253:15   0   3.6T  0 lvm  
</span></span><span class="line"><span class="cl">sdd                                     8:48   0 111.8G  0 disk 
</span></span><span class="line"><span class="cl">â””â”€sdd1                                  8:49   0 111.8G  0 part 
</span></span><span class="line"><span class="cl">  â”œâ”€hybrid-data_tmeta_rimage_0        253:2    0   5.8G  0 lvm  
</span></span><span class="line"><span class="cl">  â”‚ â””â”€hybrid-data_tmeta               253:4    0  11.5G  0 lvm  
</span></span><span class="line"><span class="cl">  â”‚   â””â”€hybrid-data                   253:15   0   3.6T  0 lvm  
</span></span><span class="line"><span class="cl">  â”œâ”€hybrid-cache_cpool_cdata_rimage_0 253:5    0   100G  0 lvm  
</span></span><span class="line"><span class="cl">  â”‚ â””â”€hybrid-cache_cpool_cdata        253:7    0   200G  0 lvm  
</span></span><span class="line"><span class="cl">  â”‚   â””â”€hybrid-data_tdata             253:14   0   3.6T  0 lvm  
</span></span><span class="line"><span class="cl">  â”‚     â””â”€hybrid-data                 253:15   0   3.6T  0 lvm  
</span></span><span class="line"><span class="cl">  â””â”€hybrid-cache_cpool_cmeta_rimage_0 253:8    0   264M  0 lvm  
</span></span><span class="line"><span class="cl">    â””â”€hybrid-cache_cpool_cmeta        253:10   0   528M  0 lvm  
</span></span><span class="line"><span class="cl">      â””â”€hybrid-data_tdata             253:14   0   3.6T  0 lvm  
</span></span><span class="line"><span class="cl">        â””â”€hybrid-data                 253:15   0   3.6T  0 lvm  
</span></span><span class="line"><span class="cl">sde                                     8:64   0 111.8G  0 disk 
</span></span><span class="line"><span class="cl">â””â”€sde1                                  8:65   0 111.8G  0 part 
</span></span><span class="line"><span class="cl">  â”œâ”€hybrid-data_tmeta_rimage_1        253:3    0   5.8G  0 lvm  
</span></span><span class="line"><span class="cl">  â”‚ â””â”€hybrid-data_tmeta               253:4    0  11.5G  0 lvm  
</span></span><span class="line"><span class="cl">  â”‚   â””â”€hybrid-data                   253:15   0   3.6T  0 lvm  
</span></span><span class="line"><span class="cl">  â”œâ”€hybrid-cache_cpool_cdata_rimage_1 253:6    0   100G  0 lvm  
</span></span><span class="line"><span class="cl">  â”‚ â””â”€hybrid-cache_cpool_cdata        253:7    0   200G  0 lvm  
</span></span><span class="line"><span class="cl">  â”‚   â””â”€hybrid-data_tdata             253:14   0   3.6T  0 lvm  
</span></span><span class="line"><span class="cl">  â”‚     â””â”€hybrid-data                 253:15   0   3.6T  0 lvm  
</span></span><span class="line"><span class="cl">  â””â”€hybrid-cache_cpool_cmeta_rimage_1 253:9    0   264M  0 lvm  
</span></span><span class="line"><span class="cl">    â””â”€hybrid-cache_cpool_cmeta        253:10   0   528M  0 lvm  
</span></span><span class="line"><span class="cl">      â””â”€hybrid-data_tdata             253:14   0   3.6T  0 lvm  
</span></span><span class="line"><span class="cl">        â””â”€hybrid-data                 253:15   0   3.6T  0 lvm
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="æ·»åŠ å­˜å‚¨">æ·»åŠ å­˜å‚¨
</h2><p>æŠŠåˆ›å»ºå¥½çš„LVM-thinå­˜å‚¨æ·»åŠ åˆ°PVEï¼Œå°±å¤§åŠŸå‘Šæˆäº†ï¼š</p>
<p><img src="/p/pve-create-lvm-thin-with-cachepool/pic1.png"
	width="1500"
	height="686"
	srcset="/p/pve-create-lvm-thin-with-cachepool/pic1_hu_48a4f9ec125e707.png 480w, /p/pve-create-lvm-thin-with-cachepool/pic1_hu_563d9e981bf9f33c.png 1024w"
	loading="lazy"
	
		alt="æ·»åŠ LVM-thinå­˜å‚¨ï¼ŒIDè‡ªå·±å–"
	
	
		class="gallery-image" 
		data-flex-grow="218"
		data-flex-basis="524px"
	
></p>
<p><img src="/p/pve-create-lvm-thin-with-cachepool/pic2.png"
	width="1500"
	height="723"
	srcset="/p/pve-create-lvm-thin-with-cachepool/pic2_hu_3dc5f70bd0c65f66.png 480w, /p/pve-create-lvm-thin-with-cachepool/pic2_hu_7ed8706a0d33ace4.png 1024w"
	loading="lazy"
	
		alt="1000è¿›åˆ¶çœ‹èµ·æ¥å°±æ˜¯4T"
	
	
		class="gallery-image" 
		data-flex-grow="207"
		data-flex-basis="497px"
	
></p>
<p>é¡ºä¾¿å†çœ‹çœ‹ç£ç›˜ç©ºé—´æœ‰æ²¡æœ‰100%åˆ©ç”¨å®Œå…¨ï¼š</p>
<p><img src="/p/pve-create-lvm-thin-with-cachepool/pic3.png"
	width="1500"
	height="632"
	srcset="/p/pve-create-lvm-thin-with-cachepool/pic3_hu_4d4bff50ee4e27fd.png 480w, /p/pve-create-lvm-thin-with-cachepool/pic3_hu_229b34611cf4d167.png 1024w"
	loading="lazy"
	
		alt="4å—ç£ç›˜éƒ½100%åˆ©ç”¨äº†"
	
	
		class="gallery-image" 
		data-flex-grow="237"
		data-flex-basis="569px"
	
></p>
<h2 id="å‚è€ƒèµ„æ–™">å‚è€ƒèµ„æ–™
</h2><p><a class="link" href="https://man.archlinux.org/man/lvm.8.en"  target="_blank" rel="noopener"
    >lvm</a>, <a class="link" href="https://man.archlinux.org/man/pvcreate.8.en"  target="_blank" rel="noopener"
    >pvcreate</a>, <a class="link" href="https://man.archlinux.org/man/vgcreate.8.en"  target="_blank" rel="noopener"
    >vgcreate</a>, <a class="link" href="https://man.archlinux.org/man/lvcreate.8.en"  target="_blank" rel="noopener"
    >lvcreate</a>, <a class="link" href="https://man.archlinux.org/man/lvconvert.8.en"  target="_blank" rel="noopener"
    >lvconvert</a>, <a class="link" href="https://man.archlinux.org/man/lvreduce.8.en"  target="_blank" rel="noopener"
    >lvreduce</a>, <a class="link" href="https://man.archlinux.org/man/lvremove.8.en"  target="_blank" rel="noopener"
    >lvremove</a>, <a class="link" href="https://man.archlinux.org/man/lvs.8.en"  target="_blank" rel="noopener"
    >lvs</a>, <a class="link" href="https://man.archlinux.org/man/lvmraid.7.en"  target="_blank" rel="noopener"
    >lvmraid</a>, <a class="link" href="https://man.archlinux.org/man/lvmthin.7.en"  target="_blank" rel="noopener"
    >lvmthin</a>, <a class="link" href="https://man.archlinux.org/man/lvmcache.7.en"  target="_blank" rel="noopener"
    >lvmcache</a></p>
<p>åœ¨ä¸Šè¿°å‚è€ƒèµ„æ–™é“¾æ¥ä¸‹æ–¹å¯ä»¥çœ‹è§å…¨éƒ¨å‘½ä»¤çš„å¸®åŠ©æ–‡æ¡£ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥ç›´æ¥åœ¨PVEå‘½ä»¤è¡Œä¸­è¾“å…¥<code>man &lt;cmd&gt;</code>æ¥æŸ¥é˜…ä¸Šè¿°æ–‡æ¡£ã€‚</p>

</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/pve/">Pve</a>
        
            <a href="/tags/lvm-thin/">Lvm-Thin</a>
        
            <a href="/tags/cachepool/">Cachepool</a>
        
    </section>


    <section class="article-lastmod">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



        <span>
            æœ€åæ›´æ–°äº 2023-10-26 21:56
        </span>
    </section></footer>


    
</article>

    

    

<aside class="related-content--wrapper">
    <h2 class="section-title">ç›¸å…³æ–‡ç« </h2>
    <div class="related-content">
        <div class="flex article-list--tile">
            
                
<article class="has-image">
    <a href="/p/debian-pve-mount-tmp-in-ram/">
        
        
            <div class="article-image">
                <img src="/p/debian-pve-mount-tmp-in-ram/pve-poster.64e7009edce642c17ad393ce579005f5_hu_2498b11f35424e53.jpg" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post Debian / PVE åœ¨å†…å­˜ä¸­æŒ‚è½½ /tmp"
                        data-key="debian-pve-mount-tmp-in-ram" 
                        data-hash="md5-ZOcAntzmQsF605POV5AF9Q==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">Debian / PVE åœ¨å†…å­˜ä¸­æŒ‚è½½ /tmp</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/pve-install-realtek-8125-driver/">
        
        
            <div class="article-image">
                <img src="/p/pve-install-realtek-8125-driver/pve-poster.64e7009edce642c17ad393ce579005f5_hu_2498b11f35424e53.jpg" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post PVE 8 å®‰è£… ReakTEK RTL8125B 2.5Gç½‘å¡é©±åŠ¨"
                        data-key="pve-install-realtek-8125-driver" 
                        data-hash="md5-ZOcAntzmQsF605POV5AF9Q==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">PVE 8 å®‰è£… ReakTEK RTL8125B 2.5Gç½‘å¡é©±åŠ¨</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/kodi-use-remote-controller/">
        
        
            <div class="article-image">
                <img src="/p/kodi-use-remote-controller/kodi-poster.037beff4acaa76a2e29b83c5da19f723_hu_c807a4fa8de008d7.jpg" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post ä¸ºKodié€‚é…é¥æ§å™¨"
                        data-key="kodi-use-remote-controller" 
                        data-hash="md5-A3vv9KyqdqLim4PF2hn3Iw==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">ä¸ºKodié€‚é…é¥æ§å™¨</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/kodi-install-in-pve/">
        
        
            <div class="article-image">
                <img src="/p/kodi-install-in-pve/pic5.ee564cee14b7850acb26de691531a3ab_hu_83a90727809fa0b2.png" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post PVE ç›´æ¥å®‰è£…æœ€æ–°ç‰ˆ Kodi"
                        data-key="kodi-install-in-pve" 
                        data-hash="md5-7lZM7hS3hQrLJt5pFTGjqw==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">PVE ç›´æ¥å®‰è£…æœ€æ–°ç‰ˆ Kodi</h2>
        </div>
    </a>
</article>

            
        </div>
    </div>
</aside>

     
    
        
    <div id="gitalk-container"></div>
<link
    rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/gitalk@1.7.2/dist/gitalk.css"
/>
<script src="https://cdn.jsdelivr.net/npm/gitalk@1.7.2/dist/gitalk.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/blueimp-md5@2.18.0/js/md5.min.js"></script>
<script>
    const gitalk = new Gitalk({
        clientID: "ceac2d88b1248ae2307e",
        clientSecret: "e987f99876ac0bcc8af0963dbe5f49f47f8c8822",
        repo: "blog",
        owner: "devome",
        admin: ["devome"],
        distractionFreeMode: false, 
        id: md5(location.pathname), 
        proxy: null ,
    });
    (function () {
        if (
            ["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1
        ) {
            document.getElementById("gitalk-container").innerHTML =
                "Gitalk comments not available by default when the website is previewed locally.";
            return;
        }
        gitalk.render("gitalk-container");
    })();
</script>



    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2020 - 
        
        2025 Evineçš„ä¸ªäººåšå®¢
    </section>
    
    <section class="powerby">
        ä½¿ç”¨ <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> æ„å»º <br />
        ä¸»é¢˜ <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.29.0">Stack</a></b> ç”± <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a> è®¾è®¡
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
